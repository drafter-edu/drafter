{"version":3,"sources":["../../src/index.ts","../../src/types/skulpt/index.ts","../../src/skulpt-tools.ts","../../src/debug/panel.ts","../../src/debug/index.ts"],"sourcesContent":["import { getSkulptFile, setupSkulpt, startServer } from \"./skulpt-tools\";\nimport { initDebugPanel } from \"./debug\";\n\nexport interface DrafterInitOptions {\n    code?: string;\n    url?: string;\n    presentErrors?: boolean;\n}\n\nconst x: pyStr = new Sk.builtin.str(\"hello\");\n\nexport function runStudentCode(options: DrafterInitOptions) {\n    setupSkulpt();\n    \n    // Initialize debug panel\n    initDebugPanel('drafter-debug--');\n\n    if (options.code) {\n        return startServer(options.code, \"main\", options.presentErrors);\n    } else if (options.url) {\n        return fetch(options.url)\n            .then((response) => {\n                if (!response.ok) {\n                    throw new Error(\n                        \"Network response was not ok \" + response.statusText\n                    );\n                }\n                return response.text(); // assuming the server returns text content\n            })\n            .then((contents) => {\n                return startServer(contents, \"main\");\n            });\n    } else {\n        throw new Error(\"Either code or url must be provided\");\n    }\n\n    console.log(\"Drafter setup complete.\");\n}\n","import \"./types\";\n\nexport const {\n    builtin: {\n        bool: { true$: pyTrue, false$: pyFalse },\n        none: { none$: pyNone },\n        NotImplemented: { NotImplemented$: pyNotImplemented },\n\n        bool: pyBool,\n        bytes: pyBytes,\n        dict: pyDict,\n        float_: pyFloat,\n        frozenset: pyFrozenSet,\n        func: pyFunc,\n        int_: pyInt,\n        list: pyList,\n        none: pyNoneType,\n        mappingproxy: pyMappingProxy,\n        module: pyModule,\n        object: pyObject,\n        set: pySet,\n        slice: pySlice,\n        sk_method: pyBuiltinFunctionOrMethod,\n        str: pyStr,\n        tuple: pyTuple,\n        type: pyType,\n\n        classmethod: pyClassMethod,\n        staticmethod: pyStaticMethod,\n        property: pyProperty,\n\n        BaseException: pyBaseException,\n        SystemExit: pySystemExit,\n        KeyboardInterrupt: pyKeyboardInterrupt,\n        GeneratorExit: pyGeneratorExit,\n        Exception: pyException,\n        StopIteration: pyStopIteration,\n        StopAsyncIteration: pyStopAsyncIteration,\n        ArithmeticError: pyArithmeticError,\n        FloatingPointError: pyFloatingPointError,\n        OverflowError: pyOverflowError,\n        ZeroDivisionError: pyZeroDivisionError,\n        AssertionError: pyAssertionError,\n        AttributeError: pyAttributeError,\n        BufferError: pyBufferError,\n        EOFError: pyEOFError,\n        ImportError: pyImportError,\n        ModuleNotFoundError: pyModuleNotFoundError,\n        LookupError: pyLookupError,\n        IndexError: pyIndexError,\n        KeyError: pyKeyError,\n        MemoryError: pyMemoryError,\n        NameError: pyNameError,\n        UnboundLocalError: pyUnboundLocalError,\n        OSError: pyOSError,\n        FileNotFoundError: pyFileNotFoundError,\n        TimeoutError: pyTimeoutError,\n        ReferenceError: pyReferenceError,\n        RuntimeError: pyRuntimeError,\n        NotImplementedError: pyNotImplementedError,\n        RecursionError: pyRecursionError,\n        SyntaxError: pySyntaxError,\n        IndentationError: pyIndentationError,\n        TabError: pyTabError,\n        SystemError: pySystemError,\n        TypeError: pyTypeError,\n        ValueError: pyValueError,\n        UnicodeError: pyUnicodeError,\n        UnicodeDecodeError: pyUnicodeDecodeError,\n        UnicodeEncodeError: pyUnicodeEncodeError,\n        ExternalError: pyExternalError,\n\n        checkString,\n        checkBool,\n        checkInt,\n        checkAnySet,\n        checkBytes,\n        checkCallable,\n        checkIterable,\n        checkNone,\n\n        issubclass: pyIsSubclass,\n        isinstance: pyIsInstance,\n        hasattr: pyHasAttr,\n    },\n    misceval: {\n        isTrue,\n        Suspension,\n        Break,\n        chain: chainOrSuspend,\n        tryCatch: tryCatchOrSuspend,\n        retryOptionalSuspensionOrThrow,\n        objectRepr,\n        buildClass: buildPyClass,\n        iterFor: iterForOrSuspend,\n        iterArray,\n        richCompareBool,\n        callsimArray: pyCall,\n        callsimOrSuspendArray: pyCallOrSuspend,\n        arrayFromIterable,\n        asyncToPromise: suspensionToPromise,\n        promiseToSuspension,\n    },\n    abstr: {\n        buildNativeClass,\n        copyKeywordsToNamedArgs,\n        checkArgsLen,\n        checkNoArg,\n        checkNoKwargs,\n        checkOneArg,\n        keywordArrayFromPyDict,\n        keywordArrayToPyDict,\n        iter: pyIter,\n        lookupSpecial,\n        typeLookup,\n        setUpModuleMethods,\n    },\n    ffi: { toPy, toJs, proxy },\n} = Sk;\n\nexport type { Args, Kws, CompareOp, BinOp, UnaryOp } from \"./namespace\";\nexport default Sk;","import Sk from \"./types/skulpt/\";\nimport type { pyBaseException, pyStr } from \"./types/skulpt/\";\n\nexport function builtinRead(path: string) {\n    if (\n        Sk.builtinFiles === undefined ||\n        Sk.builtinFiles[\"files\"][path] === undefined\n    )\n        throw \"File not found: '\" + path + \"'\";\n    return Sk.builtinFiles[\"files\"][path];\n}\n\nconst preStyle = `background-color: #f0f0f0; padding: 4px; border: 1px solid lightgrey; margin: 0px`;\n\nexport function setupSkulpt() {\n    if (typeof Sk === \"undefined\") {\n        console.error(\n            \"Skulpt (global `Sk`) not found. Ensure skulpt.js and skulpt-stdlib.js are loaded before drafter.js (served from your Python assets or a CDN).\"\n        );\n        throw new Error(\"Skulpt not found\");\n    }\n    // console.log(Sk);\n    if (typeof Sk.environ == \"undefined\") {\n        Sk.environ = new Sk.builtin.dict();\n    }\n    Sk.environ.set$item(\n        new Sk.builtin.str(\"DRAFTER_SKULPT\"),\n        Sk.builtin.bool.true$\n    );\n\n    Sk.configure({\n        read: builtinRead,\n        __future__: Sk.python3,\n    });\n\n    Sk.inBrowser = false;\n\n    if (typeof Sk.console === \"undefined\") {\n        Sk.console = {};\n    }\n    Sk.console.drafter = {};\n    Sk.console.printPILImage = function (tag: any) {\n        document.body.append(tag.image);\n    };\n    Sk.console.plot = function (chart: any) {\n        let container = document.createElement(\"div\");\n        document.body.append(container);\n        return { html: [container] };\n    };\n    Sk.console.getWidth = function () {\n        return 300;\n    };\n    Sk.console.getHeight = function () {\n        return 300;\n    };\n    Sk.console.drafter.handleError = function (code: any, message: any) {\n        document.body.innerHTML = `<h1>Error Running Site!</h1><div>There was an error running your site. Here is the error message:</div><div><pre style=\"${preStyle}\">${code}: ${message}</pre></div>`;\n    };\n\n    // Example: touch the global so TS keeps types and users see it's available\n    // (no-op to avoid side effects)\n    void Sk;\n}\n\nexport async function startServer(\n    pythonCode: string,\n    mainFilename = \"main\",\n    presentErrors = true\n): Promise<void> {\n    try {\n        return Sk.misceval\n            .asyncToPromise(() => {\n                return Sk.importMainWithBody(\n                    mainFilename,\n                    false,\n                    pythonCode,\n                    true\n                );\n            })\n            .then((result) => {\n                console.log(result.$d);\n                return result;\n            })\n            .catch((error) => {\n                if (!presentErrors) {\n                    //throw error;\n                    const errorMessage = convertSkulptError(\n                        error as pyBaseException,\n                        mainFilename + \".py\",\n                        pythonCode,\n                        false\n                    );\n                    throw errorMessage;\n                }\n                showError(error, mainFilename + \".py\", pythonCode);\n            });\n    } catch (error) {\n        if (!presentErrors) {\n            // throw error;\n            const errorMessage = convertSkulptError(\n                error as pyBaseException,\n                mainFilename + \".py\",\n                pythonCode,\n                false\n            );\n            throw errorMessage;\n        }\n        showError(error as pyBaseException, mainFilename + \".py\", pythonCode);\n    }\n}\n\nfunction showError(\n    err: pyBaseException,\n    filenameExecuted: string,\n    code: string\n) {\n    console.error(err);\n    console.error(err.args.v[0].v);\n    document.body.innerHTML = [\n        \"<h1>Error Running Site!</h1><div>There was an error running your site. Here is the error message:</div><div>\",\n        presentRunError(err, filenameExecuted, code),\n        \"</div>\",\n    ].join(\"\\n\");\n}\n\nfunction presentRunError(\n    error: pyBaseException,\n    filenameExecuted: string,\n    code: string\n) {\n    let label = error.tp$name;\n    let category = \"runtime\";\n    let message = convertSkulptError(error, filenameExecuted, code);\n\n    return message;\n}\n\nfunction buildTraceback(\n    error: pyBaseException,\n    filenameExecuted: string,\n    code: string\n) {\n    return error.traceback.reverse().map((frame) => {\n        if (!frame) {\n            return \"??\";\n        }\n        let lineno = frame.lineno;\n        let file = `File <code class=\"filename\">\"${frame.filename}\"</code>, `;\n        let line = `on line <code class=\"lineno\">${lineno}</code>, `;\n        let scope =\n            frame.scope !== \"<module>\" && frame.scope !== undefined\n                ? `in scope ${frame.scope}`\n                : \"\";\n        let source = \"\";\n        // console.log(filenameExecuted, frame.filename, code);\n        if (frame.source !== undefined) {\n            source = `\\n<pre style=\"${preStyle}\"><code>${frame.source}</code></pre>`;\n        } else if (filenameExecuted === frame.filename && code) {\n            const lines = code.split(\"\\n\");\n            const lineIndex = lineno - 1;\n            const lineContent = lines[lineIndex];\n            source = `\\n<pre style=\"${preStyle}\"><code>${lineContent}</code></pre>`;\n        }\n        return file + line + scope + source;\n    });\n}\n\nfunction buildTracebackNoHTML(\n    error: pyBaseException,\n    filenameExecuted: string,\n    code: string\n) {\n    return error.traceback.reverse().map((frame) => {\n        if (!frame) {\n            return \"??\";\n        }\n        let lineno = frame.lineno;\n        let file = `File \"${frame.filename}\", `;\n        let line = `on line ${lineno}, `;\n        let scope =\n            frame.scope !== \"<module>\" && frame.scope !== undefined\n                ? `in scope ${frame.scope}`\n                : \"\";\n        let source = \"\";\n        // console.log(filenameExecuted, frame.filename, code);\n        if (frame.source !== undefined) {\n            source = \"\" + frame.source;\n        } else if (filenameExecuted === frame.filename && code) {\n            const lines = code.split(\"\\n\");\n            const lineIndex = lineno - 1;\n            const lineContent = lines[lineIndex];\n            source = lineContent;\n        }\n        return file + line + scope + source;\n    });\n}\n\nfunction convertSkulptError(\n    error: pyBaseException,\n    filenameExecuted: string,\n    code: string,\n    withFrame: boolean = true\n) {\n    let name = error.tp$name;\n    let args = Sk.ffi.remapToJs(error.args);\n    let top = `${name}: ${args[0]}`;\n    let traceback = \"\";\n    if (name === \"TimeoutError\") {\n        if (error.err && error.err.traceback && error.err.traceback.length) {\n            const allFrames = (\n                withFrame ? buildTraceback : buildTracebackNoHTML\n            )(error.err, filenameExecuted, code);\n            const result = [\"Traceback:\"];\n            if (allFrames.length > 5) {\n                result.push(\n                    ...allFrames.slice(0, 3),\n                    `... Hiding ${\n                        allFrames.length - 3\n                    } other stack frames ...,`,\n                    ...allFrames.slice(-3, -2)\n                );\n            } else {\n                result.push(...allFrames);\n            }\n            traceback = result.join(\"\\n<br>\");\n        }\n    } else if (error.traceback && error.traceback.length) {\n        traceback =\n            (withFrame ? \"<strong>Traceback:</strong><br>\\n\" : \"Traceback:\\n\") +\n            (withFrame ? buildTraceback : buildTracebackNoHTML)(\n                error,\n                filenameExecuted,\n                code\n            ).join(\"\\n<br>\");\n    }\n    if (!withFrame) {\n        return top + \"\\n\" + traceback;\n    }\n    return `<pre style=\"${preStyle}\">${top}</pre>\\n<br>\\n${traceback}\\n<br>\\n<div>\n    <p><strong>Advice:</strong><br>\n    Some common things to check:\n    <ul>\n    <li>Check your site to make sure it has no errors and runs fine when not deployed.</li>\n    <li>Make sure you are not using third party libraries or modules that are not supported (e.g., <code>threading</code>).</li>\n    <li>Check that you are correctly referencing any files or images you are using.</li>\n    </ul>\n    </p>\n    </div>`;\n}\n\nexport function getSkulptFile(\n    path: string,\n    okayIfNotFound = true\n): string | undefined {\n    if (\n        Sk.builtinFiles !== undefined &&\n        Sk.builtinFiles[\"files\"][path] !== undefined\n    ) {\n        return Sk.builtinFiles[\"files\"][path];\n    } else {\n        if (okayIfNotFound) {\n            return undefined;\n        } else {\n            throw new Error(\"File not found: '\" + path + \"'\");\n        }\n    }\n}\n","/**\n * Debug Panel for displaying telemetry events from the Monitor.\n * \n * This module handles rendering debug information dynamically based on\n * telemetry events emitted from the backend Monitor system.\n */\n\nexport interface TelemetryEvent {\n    event_type: string;\n    correlation: {\n        causation_id?: number;\n        route?: string;\n        request_id?: number;\n        response_id?: number;\n        outcome_id?: number;\n        dom_id?: string;\n    };\n    source: string;\n    id: number;\n    version: string;\n    level?: string;\n    timestamp: string;\n    data?: any;\n}\n\nexport class DebugPanel {\n    private panelElement: HTMLElement | null = null;\n    private contentElement: HTMLElement | null = null;\n    private events: TelemetryEvent[] = [];\n    private routes: Map<string, any> = new Map();\n    private pageHistory: any[] = [];\n    private currentState: any = null;\n    private errors: any[] = [];\n    private warnings: any[] = [];\n    private isVisible: boolean = true;\n\n    constructor(private containerId: string) {\n        this.initialize();\n    }\n\n    private initialize(): void {\n        const container = document.getElementById(this.containerId);\n        if (!container) {\n            console.warn(`Debug panel container ${this.containerId} not found`);\n            return;\n        }\n\n        this.panelElement = this.createPanelStructure();\n        container.appendChild(this.panelElement);\n        this.contentElement = this.panelElement.querySelector('.drafter-debug-content');\n        this.attachEventHandlers();\n    }\n\n    private createPanelStructure(): HTMLElement {\n        const panel = document.createElement('div');\n        panel.className = 'drafter-debug-panel';\n        panel.id = 'drafter-debug-panel';\n        \n        panel.innerHTML = `\n            <div class=\"drafter-debug-header\">\n                <h3>üîç Debug Monitor</h3>\n                <div class=\"drafter-debug-actions\">\n                    <button id=\"debug-reset-btn\" title=\"Reset state and return to index\">üîÑ Reset</button>\n                    <button id=\"debug-about-btn\" title=\"Go to About page\">‚ÑπÔ∏è About</button>\n                    <button id=\"debug-save-state-btn\" title=\"Save state to localStorage\">üíæ Save State</button>\n                    <button id=\"debug-load-state-btn\" title=\"Load state from localStorage\">üìÇ Load State</button>\n                    <button id=\"debug-download-state-btn\" title=\"Download state as JSON\">‚¨áÔ∏è Download</button>\n                    <button id=\"debug-upload-state-btn\" title=\"Upload state from JSON\">‚¨ÜÔ∏è Upload</button>\n                    <button id=\"debug-toggle-btn\" title=\"Toggle debug panel\">üëÅÔ∏è</button>\n                </div>\n            </div>\n            <div class=\"drafter-debug-content\">\n                <div class=\"debug-section\" id=\"debug-errors\"></div>\n                <div class=\"debug-section\" id=\"debug-warnings\"></div>\n                <div class=\"debug-section\" id=\"debug-current-route\"></div>\n                <div class=\"debug-section\" id=\"debug-state\"></div>\n                <div class=\"debug-section\" id=\"debug-history\"></div>\n                <div class=\"debug-section\" id=\"debug-routes\"></div>\n                <div class=\"debug-section\" id=\"debug-events\"></div>\n            </div>\n        `;\n\n        return panel;\n    }\n\n    private attachEventHandlers(): void {\n        const toggleBtn = document.getElementById('debug-toggle-btn');\n        if (toggleBtn) {\n            toggleBtn.addEventListener('click', () => this.toggleVisibility());\n        }\n\n        const resetBtn = document.getElementById('debug-reset-btn');\n        if (resetBtn) {\n            resetBtn.addEventListener('click', () => this.resetState());\n        }\n\n        const aboutBtn = document.getElementById('debug-about-btn');\n        if (aboutBtn) {\n            aboutBtn.addEventListener('click', () => this.navigateToAbout());\n        }\n\n        const saveBtn = document.getElementById('debug-save-state-btn');\n        if (saveBtn) {\n            saveBtn.addEventListener('click', () => this.saveStateToLocalStorage());\n        }\n\n        const loadBtn = document.getElementById('debug-load-state-btn');\n        if (loadBtn) {\n            loadBtn.addEventListener('click', () => this.loadStateFromLocalStorage());\n        }\n\n        const downloadBtn = document.getElementById('debug-download-state-btn');\n        if (downloadBtn) {\n            downloadBtn.addEventListener('click', () => this.downloadState());\n        }\n\n        const uploadBtn = document.getElementById('debug-upload-state-btn');\n        if (uploadBtn) {\n            uploadBtn.addEventListener('click', () => this.uploadState());\n        }\n    }\n\n    public handleTelemetryEvent(event: TelemetryEvent): void {\n        this.events.push(event);\n\n        // Route different event types to appropriate handlers\n        switch (true) {\n            case event.event_type.startsWith('route.'):\n                this.handleRouteEvent(event);\n                break;\n            case event.event_type.startsWith('request.'):\n                this.handleRequestEvent(event);\n                break;\n            case event.event_type.startsWith('response.'):\n                this.handleResponseEvent(event);\n                break;\n            case event.event_type.startsWith('outcome.'):\n                this.handleOutcomeEvent(event);\n                break;\n            case event.event_type.startsWith('state.'):\n                this.handleStateEvent(event);\n                break;\n            case event.event_type.startsWith('logger.error'):\n                this.handleErrorEvent(event);\n                break;\n            case event.event_type.startsWith('logger.warning'):\n                this.handleWarningEvent(event);\n                break;\n            default:\n                // Generic event handling\n                this.updateEventsSection();\n        }\n\n        this.render();\n    }\n\n    private handleRouteEvent(event: TelemetryEvent): void {\n        if (event.event_type === 'route.added') {\n            this.routes.set(event.data?.path || 'unknown', event.data);\n        }\n    }\n\n    private handleRequestEvent(event: TelemetryEvent): void {\n        if (event.event_type === 'request.visit') {\n            // Update current route information\n            this.updateCurrentRouteSection(event.data);\n            \n            // Add to page history\n            this.pageHistory.push({\n                type: 'request',\n                timestamp: event.timestamp,\n                data: event.data,\n                request_id: event.correlation.request_id\n            });\n        }\n    }\n\n    private handleResponseEvent(event: TelemetryEvent): void {\n        if (event.event_type === 'response.created') {\n            // Track response data for history\n            if (event.data) {\n                // Find the matching request in history\n                const requestIndex = this.pageHistory.findIndex(\n                    item => item.type === 'request' && \n                    item.request_id === event.correlation.request_id\n                );\n                \n                if (requestIndex >= 0) {\n                    // Update the request entry with response data\n                    this.pageHistory[requestIndex] = {\n                        ...this.pageHistory[requestIndex],\n                        response: event.data,\n                        duration_ms: event.data.duration_ms\n                    };\n                } else {\n                    // Add as separate entry if request not found\n                    this.pageHistory.push({\n                        type: 'response',\n                        timestamp: event.timestamp,\n                        data: event.data,\n                        request_id: event.correlation.request_id,\n                        response_id: event.correlation.response_id\n                    });\n                }\n            }\n        }\n    }\n\n    private handleOutcomeEvent(event: TelemetryEvent): void {\n        // Track outcome data\n        if (event.data) {\n            this.pageHistory.push({\n                type: 'outcome',\n                timestamp: event.timestamp,\n                data: event.data\n            });\n        }\n    }\n\n    private handleStateEvent(event: TelemetryEvent): void {\n        if (event.event_type === 'state.updated') {\n            this.currentState = event.data;\n        }\n    }\n\n    private handleErrorEvent(event: TelemetryEvent): void {\n        this.errors.push(event);\n    }\n\n    private handleWarningEvent(event: TelemetryEvent): void {\n        this.warnings.push(event);\n    }\n\n    private render(): void {\n        if (!this.contentElement) return;\n\n        this.renderErrors();\n        this.renderWarnings();\n        this.renderCurrentRoute();\n        this.renderState();\n        this.renderHistory();\n        this.renderRoutes();\n        this.renderEvents();\n    }\n\n    private renderErrors(): void {\n        const section = document.getElementById('debug-errors');\n        if (!section) return;\n\n        if (this.errors.length === 0) {\n            section.style.display = 'none';\n            return;\n        }\n\n        section.style.display = 'block';\n        section.innerHTML = `\n            <h4>‚ùå Errors (${this.errors.length})</h4>\n            <div class=\"debug-messages\">\n                ${this.errors.slice(-10).map(err => `\n                    <div class=\"debug-message error-message\">\n                        <div class=\"message-header\">${this.escapeHtml(err.data?.message || 'Unknown error')}</div>\n                        <div class=\"message-meta\">\n                            <span class=\"message-source\">${this.escapeHtml(err.source)}</span>\n                            <span class=\"message-time\">${new Date(err.timestamp).toLocaleTimeString()}</span>\n                        </div>\n                        ${err.data?.details ? `\n                            <details>\n                                <summary>Details</summary>\n                                <pre>${this.escapeHtml(err.data.details)}</pre>\n                            </details>\n                        ` : ''}\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderWarnings(): void {\n        const section = document.getElementById('debug-warnings');\n        if (!section) return;\n\n        if (this.warnings.length === 0) {\n            section.style.display = 'none';\n            return;\n        }\n\n        section.style.display = 'block';\n        section.innerHTML = `\n            <h4>‚ö†Ô∏è Warnings (${this.warnings.length})</h4>\n            <div class=\"debug-messages\">\n                ${this.warnings.slice(-10).map(warn => `\n                    <div class=\"debug-message warning-message\">\n                        <div class=\"message-header\">${this.escapeHtml(warn.data?.message || 'Unknown warning')}</div>\n                        <div class=\"message-meta\">\n                            <span class=\"message-source\">${this.escapeHtml(warn.source)}</span>\n                            <span class=\"message-time\">${new Date(warn.timestamp).toLocaleTimeString()}</span>\n                        </div>\n                    </div>\n                `).join('')}\n            </div>\n        `;\n    }\n\n    private renderCurrentRoute(): void {\n        const section = document.getElementById('debug-current-route');\n        if (!section) return;\n\n        section.innerHTML = `\n            <details open>\n                <summary><h4>üó∫Ô∏è Current Route</h4></summary>\n                <div class=\"route-info\">\n                    <p><strong>Route:</strong> ${this.escapeHtml(String(this.events.find(e => e.event_type === 'request.visit')?.correlation.route || 'None'))}</p>\n                </div>\n            </details>\n        `;\n    }\n\n    private renderState(): void {\n        const section = document.getElementById('debug-state');\n        if (!section) return;\n\n        section.innerHTML = `\n            <details open>\n                <summary><h4>üìä Current State</h4></summary>\n                <div class=\"state-content\">\n                    <pre>${this.escapeHtml(JSON.stringify(this.currentState, null, 2) || 'null')}</pre>\n                </div>\n            </details>\n        `;\n    }\n\n    private renderHistory(): void {\n        const section = document.getElementById('debug-history');\n        if (!section) return;\n\n        section.innerHTML = `\n            <details open>\n                <summary><h4>üìú Page History (${this.pageHistory.length})</h4></summary>\n                <div class=\"history-content\">\n                    ${this.pageHistory.length === 0 ? '<p>No history yet</p>' : `\n                        <ul class=\"history-list\">\n                            ${this.pageHistory.slice(-20).reverse().map((item, idx) => {\n                                const route = item.data?.url || item.data?.route || 'unknown';\n                                const duration = item.duration_ms ? `${item.duration_ms.toFixed(1)}ms` : '';\n                                const status = item.response ? \n                                    `<span class=\"status-badge status-${item.response.status_code >= 400 ? 'error' : 'ok'}\">${item.response.status_code}</span>` : '';\n                                \n                                return `\n                                    <li class=\"history-item\">\n                                        <span class=\"history-index\">#${this.pageHistory.length - idx}</span>\n                                        <span class=\"history-route\">${this.escapeHtml(route)}</span>\n                                        ${duration ? `<span class=\"history-duration\">${duration}</span>` : ''}\n                                        ${status}\n                                        <span class=\"history-time\">${new Date(item.timestamp).toLocaleTimeString()}</span>\n                                        ${item.data ? `\n                                            <details class=\"history-details\">\n                                                <summary>Details</summary>\n                                                <pre>${this.escapeHtml(JSON.stringify(item.data, null, 2))}</pre>\n                                            </details>\n                                        ` : ''}\n                                    </li>\n                                `;\n                            }).join('')}\n                        </ul>\n                    `}\n                </div>\n            </details>\n        `;\n    }\n\n    private renderRoutes(): void {\n        const section = document.getElementById('debug-routes');\n        if (!section) return;\n\n        const routesList = Array.from(this.routes.entries());\n        section.innerHTML = `\n            <details>\n                <summary><h4>üõ£Ô∏è Available Routes (${routesList.length})</h4></summary>\n                <div class=\"routes-content\">\n                    ${routesList.length === 0 ? '<p>No routes registered</p>' : `\n                        <ul class=\"routes-list\">\n                            ${routesList.map(([path, data]) => `\n                                <li class=\"route-item\">\n                                    <code>${this.escapeHtml(path)}</code>\n                                    ${data?.function_name ? ` ‚Üí <code>${this.escapeHtml(data.function_name)}</code>` : ''}\n                                </li>\n                            `).join('')}\n                        </ul>\n                    `}\n                </div>\n            </details>\n        `;\n    }\n\n    private renderEvents(): void {\n        const section = document.getElementById('debug-events');\n        if (!section) return;\n\n        section.innerHTML = `\n            <details>\n                <summary><h4>üìã Recent Events (${this.events.length})</h4></summary>\n                <div class=\"events-content\">\n                    <ul class=\"events-list\">\n                        ${this.events.slice(-50).reverse().map((event, idx) => `\n                            <li class=\"event-item\">\n                                <span class=\"event-index\">#${this.events.length - idx}</span>\n                                <span class=\"event-type\">${this.escapeHtml(event.event_type)}</span>\n                                <span class=\"event-source\">${this.escapeHtml(event.source)}</span>\n                                <span class=\"event-time\">${new Date(event.timestamp).toLocaleTimeString()}</span>\n                            </li>\n                        `).join('')}\n                    </ul>\n                </div>\n            </details>\n        `;\n    }\n\n    private updateEventsSection(): void {\n        // Called for generic events\n    }\n\n    private updateCurrentRouteSection(data: any): void {\n        // Called when route changes\n    }\n\n    private toggleVisibility(): void {\n        this.isVisible = !this.isVisible;\n        if (this.contentElement) {\n            this.contentElement.style.display = this.isVisible ? 'block' : 'none';\n        }\n    }\n\n    private resetState(): void {\n        console.log('[Debug Panel] Reset state requested');\n        // Trigger navigation to index with reset\n        window.location.href = window.location.pathname;\n    }\n\n    private navigateToAbout(): void {\n        console.log('[Debug Panel] Navigate to About');\n        // Navigate to about page - would need to trigger route change\n    }\n\n    private saveStateToLocalStorage(): void {\n        try {\n            localStorage.setItem('drafter-debug-state', JSON.stringify(this.currentState));\n            console.log('[Debug Panel] State saved to localStorage');\n        } catch (e) {\n            console.error('[Debug Panel] Failed to save state:', e);\n        }\n    }\n\n    private loadStateFromLocalStorage(): void {\n        try {\n            const saved = localStorage.getItem('drafter-debug-state');\n            if (saved) {\n                this.currentState = JSON.parse(saved);\n                this.render();\n                console.log('[Debug Panel] State loaded from localStorage');\n            }\n        } catch (e) {\n            console.error('[Debug Panel] Failed to load state:', e);\n        }\n    }\n\n    private downloadState(): void {\n        try {\n            const dataStr = JSON.stringify(this.currentState, null, 2);\n            const dataUri = 'data:application/json;charset=utf-8,' + encodeURIComponent(dataStr);\n            const exportFileDefaultName = `drafter-state-${Date.now()}.json`;\n\n            const linkElement = document.createElement('a');\n            linkElement.setAttribute('href', dataUri);\n            linkElement.setAttribute('download', exportFileDefaultName);\n            linkElement.click();\n        } catch (e) {\n            console.error('[Debug Panel] Failed to download state:', e);\n        }\n    }\n\n    private uploadState(): void {\n        const input = document.createElement('input');\n        input.type = 'file';\n        input.accept = '.json';\n        input.onchange = (e: Event) => {\n            const file = (e.target as HTMLInputElement).files?.[0];\n            if (file) {\n                const reader = new FileReader();\n                reader.onload = (event) => {\n                    try {\n                        const content = event.target?.result as string;\n                        this.currentState = JSON.parse(content);\n                        this.render();\n                        console.log('[Debug Panel] State loaded from file');\n                    } catch (err) {\n                        console.error('[Debug Panel] Failed to parse state file:', err);\n                    }\n                };\n                reader.readAsText(file);\n            }\n        };\n        input.click();\n    }\n\n    private escapeHtml(text: string): string {\n        const div = document.createElement('div');\n        div.textContent = text;\n        return div.innerHTML;\n    }\n}\n\n// Export a factory function to create and initialize the debug panel\nexport function initializeDebugPanel(containerId: string = 'drafter-debug--'): DebugPanel {\n    return new DebugPanel(containerId);\n}\n","/**\n * Debug panel integration module.\n * Provides a bridge between Skulpt and the TypeScript debug panel.\n */\n\nimport { DebugPanel, TelemetryEvent } from './panel';\n\n// Global debug panel instance\nlet debugPanelInstance: DebugPanel | null = null;\n\n/**\n * Initialize the debug panel and return the instance.\n * This should be called once when the application starts.\n */\nexport function initDebugPanel(containerId: string = 'drafter-debug--'): DebugPanel {\n    if (!debugPanelInstance) {\n        debugPanelInstance = new DebugPanel(containerId);\n    }\n    return debugPanelInstance;\n}\n\n/**\n * Get the current debug panel instance.\n */\nexport function getDebugPanel(): DebugPanel | null {\n    return debugPanelInstance;\n}\n\n/**\n * Handle a telemetry event from Python/Skulpt.\n * This function can be called directly from the Skulpt bridge.\n */\nexport function handleTelemetryFromPython(eventData: any): void {\n    if (!debugPanelInstance) {\n        console.warn('[Debug Panel] Not initialized yet');\n        return;\n    }\n\n    try {\n        // Convert Python event data to TypeScript TelemetryEvent\n        const event: TelemetryEvent = {\n            event_type: eventData.event_type || 'unknown',\n            correlation: eventData.correlation || {},\n            source: eventData.source || 'unknown',\n            id: eventData.id || -1,\n            version: eventData.version || '0.0.1',\n            level: eventData.level || 'info',\n            timestamp: eventData.timestamp || new Date().toISOString(),\n            data: eventData.data\n        };\n\n        debugPanelInstance.handleTelemetryEvent(event);\n    } catch (error) {\n        console.error('[Debug Panel] Error handling telemetry:', error, eventData);\n    }\n}\n\n/**\n * Export to window for Skulpt access\n */\nif (typeof window !== 'undefined') {\n    (window as any).DrafterDebugPanel = {\n        init: initDebugPanel,\n        get: getDebugPanel,\n        handleTelemetry: handleTelemetryFromPython\n    };\n}\n"],"mappings":"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","names":["src_exports","__export","runStudentCode","pyTrue","pyFalse","pyNone","pyNotImplemented","pyBool","pyBytes","pyDict","pyFloat","pyFrozenSet","pyFunc","pyInt","pyList","pyNoneType","pyMappingProxy","pyModule","pyObject","pySet","pySlice","pyBuiltinFunctionOrMethod","pyStr","pyTuple","pyType","pyClassMethod","pyStaticMethod","pyProperty","pyBaseException","pySystemExit","pyKeyboardInterrupt","pyGeneratorExit","pyException","pyStopIteration","pyStopAsyncIteration","pyArithmeticError","pyFloatingPointError","pyOverflowError","pyZeroDivisionError","pyAssertionError","pyAttributeError","pyBufferError","pyEOFError","pyImportError","pyModuleNotFoundError","pyLookupError","pyIndexError","pyKeyError","pyMemoryError","pyNameError","pyUnboundLocalError","pyOSError","pyFileNotFoundError","pyTimeoutError","pyReferenceError","pyRuntimeError","pyNotImplementedError","pyRecursionError","pySyntaxError","pyIndentationError","pyTabError","pySystemError","pyTypeError","pyValueError","pyUnicodeError","pyUnicodeDecodeError","pyUnicodeEncodeError","pyExternalError","checkString","checkBool","checkInt","checkAnySet","checkBytes","checkCallable","checkIterable","checkNone","pyIsSubclass","pyIsInstance","pyHasAttr","isTrue","Suspension","Break","chainOrSuspend","tryCatchOrSuspend","retryOptionalSuspensionOrThrow","objectRepr","buildPyClass","iterForOrSuspend","iterArray","richCompareBool","pyCall","pyCallOrSuspend","arrayFromIterable","suspensionToPromise","promiseToSuspension","buildNativeClass","copyKeywordsToNamedArgs","checkArgsLen","checkNoArg","checkNoKwargs","checkOneArg","keywordArrayFromPyDict","keywordArrayToPyDict","pyIter","lookupSpecial","typeLookup","setUpModuleMethods","toPy","toJs","proxy","skulpt_default","builtinRead","path","skulpt_default","preStyle","setupSkulpt","tag","chart","container","code","message","startServer","pythonCode","mainFilename","presentErrors","result","error","convertSkulptError","showError","err","filenameExecuted","presentRunError","label","category","buildTraceback","frame","lineno","file","line","scope","source","lines","lineIndex","lineContent","buildTracebackNoHTML","withFrame","name","args","top","traceback","allFrames","DebugPanel","containerId","container","panel","toggleBtn","resetBtn","aboutBtn","saveBtn","loadBtn","downloadBtn","uploadBtn","event","requestIndex","item","section","err","warn","e","idx","route","duration","status","routesList","path","data","saved","dataStr","dataUri","exportFileDefaultName","linkElement","input","file","reader","content","text","div","debugPanelInstance","initDebugPanel","containerId","DebugPanel","getDebugPanel","handleTelemetryFromPython","eventData","event","error","x","runStudentCode","options","setupSkulpt","initDebugPanel","startServer","response","contents"]}