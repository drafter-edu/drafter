"use strict";var Drafter=(()=>{var d=Object.defineProperty;var S=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var v=Object.prototype.hasOwnProperty;var T=(e,r)=>{for(var n in r)d(e,n,{get:r[n],enumerable:!0})},I=(e,r,n,o)=>{if(r&&typeof r=="object"||typeof r=="function")for(let i of x(r))!v.call(e,i)&&i!==n&&d(e,i,{get:()=>r[i],enumerable:!(o=S(r,i))||o.enumerable});return e};var $=e=>I(d({},"__esModule",{value:!0}),e);var A={};T(A,{runStudentCode:()=>B});var{builtin:{bool:{true$:O,false$:M},none:{none$:P},NotImplemented:{NotImplemented$:C},bool:R,bytes:D,dict:L,float_:U,frozenset:j,func:H,int_:K,list:_,none:z,mappingproxy:G,module:J,object:V,set:W,slice:Z,sk_method:q,str:Q,tuple:X,type:Y,classmethod:ee,staticmethod:re,property:oe,BaseException:te,SystemExit:ne,KeyboardInterrupt:ie,GeneratorExit:se,Exception:pe,StopIteration:le,StopAsyncIteration:ce,ArithmeticError:ue,FloatingPointError:ae,OverflowError:ye,ZeroDivisionError:de,AssertionError:Ee,AttributeError:fe,BufferError:ge,EOFError:me,ImportError:be,ModuleNotFoundError:he,LookupError:ke,IndexError:Se,KeyError:xe,MemoryError:ve,NameError:Te,UnboundLocalError:Ie,OSError:$e,FileNotFoundError:we,TimeoutError:Fe,ReferenceError:Be,RuntimeError:Ae,NotImplementedError:Ne,RecursionError:Oe,SyntaxError:Me,IndentationError:Pe,TabError:Ce,SystemError:Re,TypeError:De,ValueError:Le,UnicodeError:Ue,UnicodeDecodeError:je,UnicodeEncodeError:He,ExternalError:Ke,checkString:_e,checkBool:ze,checkInt:Ge,checkAnySet:Je,checkBytes:Ve,checkCallable:We,checkIterable:Ze,checkNone:qe,issubclass:Qe,isinstance:Xe,hasattr:Ye},misceval:{isTrue:er,Suspension:rr,Break:or,chain:tr,tryCatch:nr,retryOptionalSuspensionOrThrow:ir,objectRepr:sr,buildClass:pr,iterFor:lr,iterArray:cr,richCompareBool:ur,callsimArray:ar,callsimOrSuspendArray:yr,arrayFromIterable:dr,asyncToPromise:Er,promiseToSuspension:fr},abstr:{buildNativeClass:gr,copyKeywordsToNamedArgs:mr,checkArgsLen:br,checkNoArg:hr,checkNoKwargs:kr,checkOneArg:Sr,keywordArrayFromPyDict:xr,keywordArrayToPyDict:vr,iter:Tr,lookupSpecial:Ir,typeLookup:$r,setUpModuleMethods:wr},ffi:{toPy:Fr,toJs:Br,proxy:Ar}}=Sk,t=Sk;function w(e){if(t.builtinFiles===void 0||t.builtinFiles.files[e]===void 0)throw"File not found: '"+e+"'";return t.builtinFiles.files[e]}var a="background-color: #f0f0f0; padding: 4px; border: 1px solid lightgrey; margin: 0px";function k(){if(typeof t>"u")throw console.error("Skulpt (global `Sk`) not found. Ensure skulpt.js and skulpt-stdlib.js are loaded before drafter.js (served from your Python assets or a CDN)."),new Error("Skulpt not found");typeof t.environ>"u"&&(t.environ=new t.builtin.dict),t.environ.set$item(new t.builtin.str("DRAFTER_SKULPT"),t.builtin.bool.true$),t.configure({read:w,__future__:t.python3}),t.inBrowser=!1,typeof t.console>"u"&&(t.console={}),t.console.drafter={},t.console.printPILImage=function(e){document.body.append(e.image)},t.console.plot=function(e){let r=document.createElement("div");return document.body.append(r),{html:[r]}},t.console.getWidth=function(){return 300},t.console.getHeight=function(){return 300},t.console.drafter.handleError=function(e,r){document.body.innerHTML=`<h1>Error Running Site!</h1><div>There was an error running your site. Here is the error message:</div><div><pre style="${a}">${e}: ${r}</pre></div>`}}async function f(e,r="main",n=!0){try{return t.misceval.asyncToPromise(()=>t.importMainWithBody(r,!1,e,!0)).then(o=>(console.log(o.$d),o)).catch(o=>{if(!n)throw E(o,r+".py",e,!1);m(o,r+".py",e)})}catch(o){if(!n)throw E(o,r+".py",e,!1);m(o,r+".py",e)}}function m(e,r,n){console.error(e),console.error(e.args.v[0].v),document.body.innerHTML=["<h1>Error Running Site!</h1><div>There was an error running your site. Here is the error message:</div><div>",F(e,r,n),"</div>"].join(`
`)}function F(e,r,n){let o=e.tp$name,i="runtime";return E(e,r,n)}function b(e,r,n){return e.traceback.reverse().map(o=>{if(!o)return"??";let i=o.lineno,c=`File <code class="filename">"${o.filename}"</code>, `,u=`on line <code class="lineno">${i}</code>, `,p=o.scope!=="<module>"&&o.scope!==void 0?`in scope ${o.scope}`:"",s="";if(o.source!==void 0)s=`
<pre style="${a}"><code>${o.source}</code></pre>`;else if(r===o.filename&&n){let l=n.split(`
`),y=i-1,g=l[y];s=`
<pre style="${a}"><code>${g}</code></pre>`}return c+u+p+s})}function h(e,r,n){return e.traceback.reverse().map(o=>{if(!o)return"??";let i=o.lineno,c=`File "${o.filename}", `,u=`on line ${i}, `,p=o.scope!=="<module>"&&o.scope!==void 0?`in scope ${o.scope}`:"",s="";if(o.source!==void 0)s=""+o.source;else if(r===o.filename&&n){let l=n.split(`
`),y=i-1;s=l[y]}return c+u+p+s})}function E(e,r,n,o=!0){let i=e.tp$name,c=t.ffi.remapToJs(e.args),u=`${i}: ${c[0]}`,p="";if(i==="TimeoutError"){if(e.err&&e.err.traceback&&e.err.traceback.length){let s=(o?b:h)(e.err,r,n),l=["Traceback:"];s.length>5?l.push(...s.slice(0,3),`... Hiding ${s.length-3} other stack frames ...,`,...s.slice(-3,-2)):l.push(...s),p=l.join(`
<br>`)}}else e.traceback&&e.traceback.length&&(p=(o?`<strong>Traceback:</strong><br>
`:`Traceback:
`)+(o?b:h)(e,r,n).join(`
<br>`));return o?`<pre style="${a}">${u}</pre>
<br>
${p}
<br>
<div>
    <p><strong>Advice:</strong><br>
    Some common things to check:
    <ul>
    <li>Check your site to make sure it has no errors and runs fine when not deployed.</li>
    <li>Make sure you are not using third party libraries or modules that are not supported (e.g., <code>threading</code>).</li>
    <li>Check that you are correctly referencing any files or images you are using.</li>
    </ul>
    </p>
    </div>`:u+`
`+p}var Rr=new Sk.builtin.str("hello");function B(e){if(k(),e.code)return f(e.code,"main",e.presentErrors);if(e.url)return fetch(e.url).then(r=>{if(!r.ok)throw new Error("Network response was not ok "+r.statusText);return r.text()}).then(r=>f(r,"main"));throw new Error("Either code or url must be provided");console.log("Drafter setup complete.")}return $(A);})();
//# sourceMappingURL=drafter.js.map