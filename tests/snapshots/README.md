# Component HTML Snapshot Tests

This directory contains snapshot tests for the HTML output of Drafter components. These tests ensure that the HTML generated by components matches expected output, making it easy to catch unintended changes.

## What are Snapshot Tests?

Snapshot tests capture the exact output of components and save it as "snapshots" - text files containing the expected HTML. When tests run, the current component output is compared against these snapshots. If they don't match, the test fails.

## Running the Tests

### Run all component HTML tests
```bash
pytest tests/test_component_html.py -v
```

### Run a specific test
```bash
pytest tests/test_component_html.py::test_header_level_1 -v
```

## Updating Snapshots

When you intentionally change component HTML (for example, adding a new attribute or changing the output format), you need to update the snapshots:

```bash
pytest tests/test_component_html.py --update-snapshots
```

This will regenerate all snapshot files with the new HTML output. Always review the changes before committing them to ensure they match your expectations.

### Best Practices for Updating Snapshots

1. **Review changes carefully**: Use `git diff` to see what HTML changed
2. **Update selectively**: If you only changed one component, you can update just that test:
   ```bash
   pytest tests/test_component_html.py::test_header_level_1 --update-snapshots
   ```
3. **Commit snapshots with code changes**: When you modify component code, commit the updated snapshots together

## Snapshot Files

Snapshots are stored in `tests/snapshots/component_html/`. Each test has a corresponding `.html` file containing the expected output.

For example:
- `test_header_level_1` → `tests/snapshots/component_html/header_level_1.html`
- `test_bulleted_list` → `tests/snapshots/component_html/bulleted_list.html`

## Adding New Tests

To test a new component or variation:

1. Add a test function to `test_component_html.py`:
   ```python
   def test_my_new_component(request):
       """Test description"""
       component = MyComponent(...)
       html = str(component)
       assert_matches_snapshot("my_new_component", html, request)
   ```

2. Generate the snapshot:
   ```bash
   pytest tests/test_component_html.py::test_my_new_component --update-snapshots
   ```

3. Verify the snapshot looks correct:
   ```bash
   cat tests/snapshots/component_html/my_new_component.html
   ```

4. Run the test normally to ensure it passes:
   ```bash
   pytest tests/test_component_html.py::test_my_new_component -v
   ```

## Components Tested

The following component types are currently tested:

- **Text Components**: Header, Text
- **Lists**: BulletedList, NumberedList
- **Containers**: Div, Span, Box, Row, Pre
- **Tables**: Table (with and without headers)
- **Form Inputs**: TextBox, TextArea, SelectBox, CheckBox
- **Other**: LineBreak, HorizontalRule, Argument
- **Nested Components**: Various combinations of the above

## Why Snapshot Testing?

Snapshot testing for component HTML provides several benefits:

1. **Catch unintended changes**: If someone accidentally modifies component output, tests will fail
2. **Easy to update**: When changes are intentional, updating is a single command
3. **Clear diffs**: Git shows exactly what changed in the HTML
4. **Comprehensive coverage**: Tests cover many variations (attributes, styles, nesting, etc.)
5. **Documentation**: Snapshots serve as examples of what each component produces

## Example Workflow

Let's say you're adding a new CSS class to all Div components:

1. Modify the component code in `drafter/components.py`
2. Run tests to see what changed:
   ```bash
   pytest tests/test_component_html.py -v
   ```
3. Review the test failures to ensure changes match expectations
4. Update the snapshots:
   ```bash
   pytest tests/test_component_html.py --update-snapshots
   ```
5. Review the changes:
   ```bash
   git diff tests/snapshots/
   ```
6. Commit both the code and snapshot changes:
   ```bash
   git add drafter/components.py tests/snapshots/
   git commit -m "Add default CSS class to Div components"
   ```
